/* ------------------------------------------------------------------------------

	eBookRTE - Version: 1.67 - Revision 0 (Agust 16, 2015)
	Rich-Text Editor : http://www.eboockcms.com/
	Copyright (C) 2015 Rui Mendes. All Rights Reserved. 
	eBookRTE is licensed under a "Creative Commons License"

--------------------------------------------------------------------------------- */

function FindObject(e){var t=Objects.length;for(var n=0;n<nObjs;n++){if(Objects[n].name==e){return Objects[n]}}}var Objects=[],nObjs=0;var msg=["switchmode|Change Mode (CODE/HTML)|smo","bold|Bold|bol","italic|Italic|ita","underline|Underline|und","strikethrough|Strike|stk","h1|Heading 1|h1","h2|Heading 2|h2","h3|Heading 3|h3","justifyleft|Align left|alf","justifycenter|Align center|ace","justifyright|Align right|ari","subscript|Subscript|sub","superscript|Superscript|sup","insertparagraph|Insert Paragraph|par","linebreak|Line Break|lbr","insertorderedlist|Ordered List|oli","insertunorderedlist|Unordered list|uli","table|Insert table|tbl","image|insert image|img","link|Insert link|lnk","unlink|Remove Link|ulk","address|Address|adr","div|Division or section|div","span|Group inline|spn","blockquote|Blockquote|blq","pre|Preformatted|pre","code|Code|cod","table|Insert table|tbl","image|insert image|img","link|Insert link|lnk","unlink|Remove Link|ulk","youtube|YouTube|ytb","clean_tags|Clean Tags|clt"];var warnings=["eBookRTE constructor(editor, objName, html code, cssfile) failed, four arguments are required","Designmode is not support by your browser, please update.","List already exists","Command not supported by your browser","This command is not supported when you selected this object.","Please select some text to use this function","Table already exists","Move cursor to end </li> tag","Old Browser, is best you upgrade"];var msgpr=["Enter a URL:","Enter a Title:","Enter a Image URL:","Enter a Alt:","Enter a border size:","How many rows","How many cells","Youtube Video"];function ebookRTE(e){this.numName=nObjs;Objects[nObjs]=this;nObjs++;if(document.getElementById){var t=document.getElementById(e)}else{alert("Your browser lacks the capabilities required to run this script!");exit()}this.name=e;this.rows=t.rows;this.cols=t.cols;this.txteditor="ebook"+e;this.htmeditor="ebhtm"+e;this.html=t.value;this.html=this.html.replace(/(\&CR\;)/gi,"\n");this.cssfile="css/content.css";this.cssfile1="";this.isEditable=true;this.wwidth=650;this.wheight=300;this.iconHeight=16;this.iconWidth=16;this.toolbar1="split,switchmode,split,bold,italic,underline,strikethrough,split,justifyleft,justifycenter,justifyright,split,subscript,superscript,split,insertorderedlist,insertunorderedlist,split,insertparagraph,linebreak,line,split,table,image,link,unlink,clean_tags,split,h1,h2,h3,split";this.nToolbars=0;this.externalcmds="switchmode,table,image,newLink,youtube,clean_tags";this.outcmds="span,pre";this.DOMcommands="bold,italic,underline,strikethrough,justifyleft,justifycenter,justifyright,insertorderedlist,insertunorderedlist,insertHTML,subscript,superscript,link,unlink,inserthorizontalrule";this.insHTML="insertparagraph,h1,h2,h3,address,blockquote,div,linebreak,span,code,pre";this.BBcode="";this.ytWidth=640;this.ytHeight=480;this.ytfborder=0;this.divcontent="main_content";this.ytoptions="allowfullscreen";this.smilley="";this.smilleyext=".png";this.smilleytxt="";this.addcmde="";this.addcmdi="";t.setAttribute("style","display: none; margin: 0px; padding: 0px; border: none; font-size:0;");this.prepareEditor()};ebookRTE.prototype={detectBrowser:function(){var e="";var t=navigator.userAgent.toLowerCase();if(t.indexOf("opera")!=-1){e="opera"}else if(t.indexOf("msie")!=-1){e="msie"}else if(t.indexOf("chrome")!=-1){e="chrome"}else if(t.indexOf("safari")!=-1){e="safari"}else if(t.indexOf("android")!=-1){e="android"}else if(t.indexOf("mozilla")!=-1){if(t.indexOf("firefox")!=-1){e="firefox"}else{e="mozilla"}}return e},add_captions:function(e){alert(e);msg.push(e)},add_cmd:function(e,t){this.externalcmds+=this.externalcmds!==""?","+e:e;if(langs!=""){msg.push(t)}},prepareEditor:function(){if(this.toolbar1!==""&&this.toolbar1!==null&&this.toolbar1!==undefined){this.nToolbars++}if(this.toolbar2!==""&&this.toolbar2!==null&&this.toolbar2!==undefined){this.nToolbars++}if(this.toolbar3!==""&&this.toolbar3!==null&&this.toolbar3!==undefined){this.nToolbars++}if(this.toolbar4!==""&&this.toolbar4!==null&&this.toolbar4!==undefined){this.nToolbars++}if(this.smilleytxt!=""){var e=this.smilleytxt;e=e.split(",");for(var t=0;t<e.length;t++){msg.push(e[t])}}if(this.addcmde!=""){var n=this.addcmde;var r=n.split(",");for(var t=0;t<r.length;t++){this.externalcmds+=this.externalcmds!==""?","+r[t]:r[t]}}if(this.addcmdi!=""){var i=this.addcmdi;var s=i.split(",");for(var t=0;t<s.length;t++){var o=s[t].split("|");var u=o[0];this.externalcmds+=this.externalcmds!==""?","+o[0]:o[0];this.add_newcmd(u,o[3],o[4],o[5],"");var a=u+"|"+o[1]+"|"+o[2];msg.push(a)}}},showButtoms:function(e){var t="",n="",r="",i="",s="",o="";if(e.indexOf("bbc")!=-1){s=e.substring(3);i=FindMsg(s)}else{i=FindMsg(e)}switch(e){case"link":e="newLink";o="link.png";if(i){n=i.title;r=i.alt}break;case"line":e="inserthorizontalrule";o="line.png";if(i){n=i.title;r=i.alt}break;default:t=e;if(this.smilley.indexOf(e)!=-1){o=e+this.smilleyext}else if(this.BBcode.indexOf(e)!=-1&&s!=""){o=s+".png"}else{o=e+".png"}if(i){n=i.title;r=i.alt;o=e+".png"}break}var u="<li><a href=\"javascript: editorCommand('"+this.numName+"', '"+e+"');\"";u+=' id ="bt'+this.txteditor+e+'" title ="'+n+'">';u+='<img src="js/editor/'+o+'" width="'+this.iconWidth+'px" height="'+this.iconHeight+'px" alt="'+r+'"></a></li>';return u},designer:function(){if(this.isEditable!==true){return}var e="<html><head>";e+='<link rel="stylesheet" type="text/css" href="'+this.cssfile+'" />';if(this.cssfile1!=""){e+='<link rel="stylesheet" type="text/css" href="'+this.cssfile1+'" />';};e+="<style>* {margin:0; padding:0;} body{background: #FFF; padding: 15px;}</style>";e+="</head><body class="+this.divcontent+">";e+=this.loadhtml(this.html)+"</body></html>";try{var t=document.getElementById(this.htmeditor);var n="";if(t.contentDocument&&t.contentDocument.document){n=t.contentDocument.document}else if(t.contentWindow&&t.contentWindow.document){n=t.contentWindow.document}else if(t.documentMode){n=t.documentMode}else if(t.compatMode){n=t.documentMode}else{n=t.document}if(n&&n==""){alert("Old Browser, not supported");return}n.open();n.write(e);n.close();n.designMode="On";if(t.contentDocument&&t.contentDocument.designMode){t.contentDocument.designMode="on"}}catch(r){alert("Some error in designer mode - "+r.name+": "+r.message)}},drawToolbar:function(e){var t=e;bt="";if(e!==""&&e!==null){t=t.split(",");var n='<li><img src="js/editor/split.png"></li>';var r="<li>&nbsp;</li>";for(var i=0;i<t.length;i++){switch(t[i]){case"space":bt+=r;break;case"split":bt+=n;break;default:if(t[i]){bt+=this.showButtoms(t[i])}break}}}return bt},WscrollBarWidth:function(){document.body.style.overflow="hidden";var e=document.body.clientWidth;document.body.style.overflow="scroll";e-=document.body.clientWidth;if(!e){e=document.body.offsetWidth-document.body.clientWidth}document.body.style.overflow="";return e},displayEditor:function(){this.prepareEditor();var e=this.showButtons(this.txteditor),t;var n=this.WscrollBarWidth();var r=this.iconHeight;var i=this.nToolbars*(r+6);var s=this.wheight+i;if(n==0){n=18}document.writeln('<style type="text/css">');document.writeln("textarea#"+this.name+" {display: none; margin: 0px; padding: 0px; border: none; font-size: 0;}");document.writeln(".editor_clear {clear: both; padding-bottom: 5px;}");document.writeln("div."+this.name+"_editor {width: "+this.wwidth+"px; height: "+s+"px; max-height: "+s+"px;}");document.writeln("div."+this.name+"_toolbar {width: "+this.wwidth+"px; height: "+i+"px; background: gray;}");document.writeln("div."+this.name+"_linebar {width: "+this.wwidth+"px; height: "+(r+7)+"px; background: #ddd; border-bottom: 1px solid gray;}");document.writeln("div."+this.name+"_linebar ul {list-style: none; margin: 0px; clear: both; padding: 2px;}");document.writeln("div."+this.name+"_linebar li {float: left; list-style: none; display: inline; height: "+(r+4)+"px; margin-left: 1px; clear: none;}");document.writeln("div."+this.name+"_linebar li a {list-style: none;}");document.writeln("div."+this.name+"_linebar li a:hover img {background: #eee; margin:2px; padding: 0px; background: #ccc;}");document.writeln("div."+this.name+"_linebar li a img {border: none; margin:2px;}");document.writeln("div."+this.txteditor+" {width: "+(this.wwidth-2)+"px; height: "+(this.wheight-3)+"px; display : block; background: #ddd;}");document.writeln("div."+this.txteditor+" iframe {width: "+(this.wwidth-4)+"px; margin: 1px; height: "+(this.wheight-7)+"px; border: 1px #000 solid;}");document.writeln("div."+this.txteditor+" textarea {width: "+(this.wwidth-n+2-12)+"px; margin: 1px; height: "+(this.wheight-31)+"px; resize: none; padding: 12px;}");document.writeln("</style>");document.writeln('<div class="'+this.name+'_editor">');document.writeln(e);document.writeln('<div class="'+this.txteditor+'" name="'+this.txteditor+'">');document.writeln('<div class="feditor"><iframe id="'+this.htmeditor+'" name="'+this.htmeditor+'" frameborder="0"></iframe></div>');document.writeln('<div class="feditor"><textarea id="'+this.txteditor+'" name="'+this.txteditor+'" >'+this.loadtext(this.html)+"</textarea></div>");document.getElementById(this.htmeditor).htmeditor=this.loadhtml(this.html);document.writeln('</div></div><div class="editor_clear"></div>');this.designer();if(this.isEditable){t=document.getElementById(this.txteditor)}else{t=document.getElementById(this.htmeditor)}t.removeAttribute("style");t.setAttribute("style","display: none; margin: 0px; padding: 0px; border: none; font-size: 0;");t.style.cssText="display: none; margin: 0px; padding: 0px; border: none; font-size: 0;"},checkSubText:function(e,t,n){if(!t){return null}var r=t.split("|"),i=r.length,s=0,o=false,u="",a="",f="",l="",c="";var h=new Array,p=new Array,d=0,v="";t=t.split("??");if(e!=null&&e!=""){for(var m=0;m<i;m++){v=r[m];if(v.indexOf("??")>-1){v=r[m].split("??");u=v[0]?v[0]:"";a=v[1]?v[1]:"";s=e.indexOf(u)>-1&&u!=""?u.length:0;v=u;if(e.indexOf(u)>-1){v+=e.substring(e.indexOf(u)+s,e.indexOf(a))}v+=a}if(e.indexOf(v)>-1){o=true;d++;h[d]=v;p[d]=r[m]}}if(o){if(h[1].indexOf("/")>-1){c=h[1]}else{l=h[1]}if(h[2].indexOf("/")>-1){c=h[2]}else{l=h[2]}}}if(n=="0"){return o}else{return{myKeys:p,myText:h,isSub:o,tag1:l,tag2:c}}},checkText:function(e,t,n,r,i){var s="",o=e.toLowerCase(),u="",a="",f="";var l=o.indexOf(t);pos2=o.indexOf(n);var c=t!==""&&t!==null?t.length:0;var h=n!==""&&n!==null?n.length:0;if(l>-1&&pos2>-1){o=e.substring(0,l)+e.substring(l+c,pos2)+e.substring(pos2+h)}else{o=e}switch(r){case"1":s=t;break;case"2":s=t;u=n;break;case"3":if(l==-1&&pos2==-1){s=t.toLowerCase();u=n.toLowerCase()}break;case"4":var p=this.checkSubText(e,"<ul>|</ul>|<ol>|</ol>",0);if(p){alert(warnings[2]);a="<li>";f="</li>"}else if(l===-1&&pos2===-1&&!p){s=t.toLowerCase();u=n.toLowerCase()}else{s=null;o=null}break;case"5":if(l==-1&&pos2==-1){s=t;u=n+" \n"}break;case"6":if(l==-1&&pos2==-1){s=t;u=""}break;default:break}return{txt1:s,txt2:o,txt3:u,txt4:a,txt5:f}},lasttag:function(){var e=document.getElementById(this.txteditor),t="",n="",r,i;if(!e.setSelectionRange){}else{var s=e.value.substring(0,e.selectionStart);var o=e.value.substring(e.selectionEnd,e.value.length);r=s.lastIndexOf("<");t=s.substring(r);r=t.indexOf(">");t=t.substring(0,r+1);r=o.indexOf("<");i=o.indexOf(">",r);nexttag=o.substring(r,i)}return{lasttag:t,nexttag:nexttag}},editorCommand:function(e,t,n,r,i){var s=this.DOMcommands,o=this.insHTML,u,a,f=e,l=this.browser;if(this.isEditable&&s.indexOf(e)!=-1){u=document.getElementById(this.htmeditor).contentWindow;try{u.focus();u.document.execCommand(e,false,t);u.focus()}catch(c){alert(warnings[3])}}else{var h=this.externalcmds;if(h.indexOf(e)!=-1){this[e]();return}var p=this.outcmds;if(p.indexOf(e)!=-1){this.special(e,n,r);return}if(e.indexOf("bbc")!=-1){var d=e.substring(3);e=d}switch(e){case"bold":if(l=="msie"||l=="opera"){n="<strong>";r="</strong>"}else if(l=="firefox"){n='<span style="font-weight: bold;">';r="</span>"}else{n="<b>";r="</b>"}i="3";break;case"italic":if(l=="msie"||l=="opera"){n="<em>";r="</em>"}else if(l=="firefox"){n='<span style="font-style: italic;">';r="</span>"}else{n="<i>";r="</i>"}i="3";break;case"underline":if(l=="firefox"){n='<span style="text-decoration: underline;">';r="</span>"}else{n="<u>";r="</u>"}i="3";break;case"strikethrough":if(l=="firefox"){n='<span style="text-decoration: line-through;">';r="</span>"}else{n="<strike>";r="</strike>"}i="3";break;case"unlink":var v=this.getText();var m=v.indexOf("<a "),g=v.indexOf(">",m);var n=v.substring(m,g+1);n=n.toLowerCase();r="</a>";i="3";break;case"insertparagraph":n="<p>";r="</p>";i="3";f="";break;case"inserthorizontalrule":n="\n<hr>";r="\n";i="2";break;case"h1":case"h2":case"h3":f="formatBlock";n="<"+e+">";r="</"+e+">";i="3";break;case"linebreak":n="<br>";r="\n";i="2";break;case"insertunorderedlist":case"insertorderedlist":var y=this.lasttag(),b=e==="insertunorderedlist"?"ul":"ol";if(y.lasttag==="</li>"){n="<li>";r="</li>";i="3"}else if(y.lasttag!=="<li>"){n="<"+b+"><li>";r="</li></"+b+">";i="4"}else{alert(warnings[7])}break;case"code":n='<ol class="code"><li><code>Your code';r="</code></li></ol><br />";i="3";f="";break;case"subscript":n="<sub>";r="</sub>";i="3";break;case"superscript":n="<sup>";r="</sup>";i="3";break;default:if(this.smilley.indexOf(e)!=-1){f="smilley";n='<img src="js/editor/'+e+this.smilleyext+'" />';i="1"}else if(o.indexOf(e)!=-1){n="<"+e+">";r="</"+e+">";i="3"}break}if(o.indexOf(e)!=-1){this["insertHtml"](f,n,r,i);return}var w=this.smilley;if(w.indexOf(e)!=-1){this.putsmilley(n);return}var E=document.getElementById(this.txteditor);if(!E.setSelectionRange){var S=E.scrollTop;try{E.focus()}catch(c){}var x=document.selection.createRange(this.txteditor);var T=x.text;if(T.length<=0){var N=n;if(r!==""&&r!==null){N+=r}}else{var C=this.checkText(T,n,r,i);N=C.txt2;if(C.txt1!==null&&C.txt3!==null){N=C.txt1+C.txt2+C.txt3}}if(N){x.text=N}try{E.focus()}catch(c){}E.scrollTop=S;try{E.focus()}catch(c){}x.select()}else{var k=E.value.substring(0,E.selectionStart);var L=E.value.substring(E.selectionEnd,E.value.length);var A=this.checkText(E.value.substring(E.selectionStart,E.selectionEnd),n,r,i);var O=A.txt1+A.txt2,M;if(i==3){M=A.txt1.length+A.txt2.length}else{M=O.length}O+=A.txt3;if(A.txt4!=""){O=O.replace(A.txt4,"")}if(A.txt5!=""){O=O.replace(A.txt5,"")}E.focus();E.value=k+O+L;E.selectionStart=k.length+M;E.selectionEnd=k.length+M;E.focus()}}},switchmode:function(){var e=this.wwidth,t=this.wheight;var n="";var r=null;var i="";var s=null;if(this.isEditable){obj1=document.getElementById(this.htmeditor);obj2=document.getElementById(this.txteditor);this.html=this.htmlclean(obj1.contentWindow.document.body.innerHTML);this.isEditable=false}else{obj1=document.getElementById(this.txteditor);obj2=document.getElementById(this.htmeditor);this.html=this.txtclean(obj1.value);this.isEditable=true;try{obj2.setfocus()}catch(o){}}obj1.removeAttribute("style");obj1.setAttribute("style","display: none; margin: 0px; padding: 0px; border: none; font-size: 0;");obj1.style.cssText="display: none; margin: 0px; padding: 0px; border: none; font-size: 0;";obj2.removeAttribute("style");if(this.isEditable!==false){this.designer()}obj2.value=this.html;this.editor_focus();return},insertHtml:function(e,t,n,r,i){var s;if(!this.isEditable){this.editorCommand("insertHTML",e,t,n,r);return}if(document.all){var o=frames[this.htmeditor].document.selection;if(o!=null){frames[this.htmeditor].focus();o=o.createRange().text}var u=this.checkText(o,t,n,r,i);o=u.txt2;if(u.txt1!=null&&u.txt3!=null){o=u.txt1+u.txt2+u.txt3}s=document.getElementById(this.htmeditor).contentWindow.document.selection.createRange(this.htmeditor);try{s.pasteHTML(o);s.collapse(false);s.select()}catch(a){alert(warnings[4])}}else{var o="";if(document.getElementById(this.htmeditor).contentWindow){o=document.getElementById(this.htmeditor).contentWindow.getSelection();this.editorCommand("insertHTML",t+o+n,"","",r,i)}}},getText:function(){if(document.all){var e=this.isEditable?frames[this.htmeditor].document.selection:document.selection.createRange(this.htmeditor).text;if(e!=null&&this.isEditable){frames[this.htmeditor].focus();e=e.createRange().text}}else{var t=document.getElementById(this.ehidden);var e=this.isEditable?document.getElementById(this.htmeditor).contentWindow.getSelection():t.value.substring(t.selectionStart,t.selectionEnd)}return e},editor_focus:function(){var e=this.isEditable?document.getElementById(this.htmeditor).contentWindow:document.getElementById(this.txteditor);e.focus()},isSelect:function(){var e=this.getText();if(e==null||e==""){alert(warnings[5]);this.editor_focus(this.editor);return false}return true},newLink:function(){if(!this.isSelect()){return}var e=prompt(msgpr[0],"http://");if(e!=null&&e!=""&&e!="http://"){var t=prompt(msgpr[1]);this.insertHtml("",'<a href="'+e+'" title="'+t+'" />',"</a>","2")}else{this.editor_focus()}},removeLink:function(){if(!this.isSelect()){return}var e=prompt(msgpr[0],"http://");if(e!=null&&e!=""&&e!="http://"){var t=prompt(msgpr[1]);this.insertHtml("",'<a href="'+e+'" title="'+t+'" />',"</a>","2")}else{this.editor_focus()}},table:function(){var e=this.getText();var t=this.checkSubText(e,"<table|<tr>|</tr>|<td>|</td>",0);if(t){alert(warnings[6]);return}var n=prompt(msgpr[4],"1");if(!n){return}var r=prompt(msgpr[5],"1");if(!r){return}var s=prompt(msgpr[6],"1");if(!s){return}if(n!=null&&n!=""){var o="";var o='<table border="'+n+'"';o+=">";for(i=0;i<s;i++){o+="<tr>";for(j=0;j<r;j++){o+="<td>"+(i+1)+","+(j+1)+"</td>"}o+="</tr>"}this["insertHtml"]("table",o,"</table>\n","3")}},image:function(){var e=prompt(msgpr[2],"http://");if(e!=null&&e!=""&&e!="http://"){var t=prompt(msgpr[3]);var n='<img src="'+e+'" alt="'+t+'"';this["insertHtml"]("image",n," />","3")}else{this.editor_focus()}},special:function(e,t,n){if(e!==null&&e!==""&&e!=="undefined"){var r=this.getText();if(r!==null&&r!==""){r=""}else{r="Some Text"}this["insertHtml"]("special","<"+e+">"+r,"</"+e+">","5")}else{this.editor_focus()}},youtube:function(){var e=prompt("Video","");if(e!=null&&e!=""){e=e.replace("http://youtu.be/","");var t='<iframe width="'+this.ytWidth+'" height="'+this.ytHeight+'" src="http://www.youtube.com/embed/'+e+'" frameborder="'+this.ytfborder+'" '+this.ytoptions+">";this["insertHtml"]("video",t,"</iframe>","6")}else{this.editor_focus()}},showButtons:function(e){var t="";t+='<div class="'+this.name+'_tollbar">';if(this.toolbar1!==""&&this.toolbar1!==null&&this.toolbar1!==undefined){var n=this.drawToolbar(this.toolbar1);if(n!==""){t+='<div class="'+this.name+'_linebar"><ul>'+n+"</ul></div>"}}if(this.toolbar2!==""&&this.toolbar2!==null&&this.toolbar2!==undefined){var r=this.drawToolbar(this.toolbar2);if(r!==""){t+='<div class="'+this.name+'_linebar"><ul>'+r+"</ul></div>"}}if(this.toolbar3!==""&&this.toolbar3!==null&&this.toolbar3!==undefined){var i=this.drawToolbar(this.toolbar3);if(i!==""){t+='<div class="'+this.name+'_linebar"><ul>'+i+"</ul></div>"}}if(this.toolbar4!==""&&this.toolbar4!==null&&this.toolbar4!==undefined){var s=this.drawToolbar(this.toolbar4);if(s!==""){t+='<div class="'+this.name+'_linebar"><ul>'+s+"</ul></div>"}}t+="</div>";return t},loadtext:function(e){e=e.replace(/\&#/gi,"&#");e=e.replace(/(\<)(xss|script|body|html|title|iframe|input|style)([^><]*){0,}(\>){0,}(\<){0,}/gi,"&lt;$2$3&gt;$5");e=e.replace(/(\<)(\s)(p|div|pre|code|blockquote)([^><\s]*)(\s){0,}(\>)/gi,"&lt;$3$4&gt;");e=e.replace(/(\<)(img)(\s[^>]*){0,}(javascript|on\w+\=|\&#|\t|DYNSRC|LOWSRC)([^><]*){0,}(\>){0,}(\>){0,}/gi,"&lt;$2$3$4$5&gt;$7");e=e.replace(/(\<)(li)(\>)([^<>]*)(\<\/\2\>){0,}/gi,"<$2>$4</$2>");e=e.replace(/(\<)(ul)([^>]*){0,}(\>){1,}((\<li\>[^<]*\<\/li\>){1,})(\<\/\2\>){1,}/gi,"<$2$3>$5</$2>$7");return e},loadhtml:function(e){e=e.replace(/\\\'/gi,"'");e=e.replace(/\\\"/gi,'"');e=e.replace(/\&#/gi,"&#");e=e.replace(/\r{3,}/gi,"");e=e.replace(/(\<)(iframe)((\x20(width|height|frameborder)="\d+"|allowfullscreen){0,})(\x20src="(http\:\/\/www\.youtube\.com\/embed\/\w+)")([^><]*)(\>\<\/iframe\>)/gi,"[video=youtube]$7[/video]");e=e.replace(/(\<)(xss|script|body|html|title|iframe|input|style)([^><]*){0,}(\>){0,}(\<){0,}/gi,"&#60;$2$3&#62;$5");e=e.replace(/(\<\/)(xss|script|body|title|iframe|style)(\>)/gi,"&lt;/$2&gt;");e=e.replace(/(\<)(img)(\s[^>]*){0,}(javascript|on\w+\=|\&#|\t|DYNSRC|LOWSRC)([^><]*){0,}(\>){0,}(\<){0,}/gi,"&lt;$2$3$4$5&gt;$7");e=e.replace(/(\<)(img)(\s\"\"\")([^>]*){0,}(\>)/gi,"&lt;$2$3$4&gt;");e=e.replace(/(\<)(\?php)([^>]*)(\>)/gi,"&lt;$2$3&gt;");e=e.replace(/(\<)(!--)([^>]*)(--)(\>)/gi,"&lt;$2$3$4&gt;");e=e.replace(/(\[)(video=youtube\])(http\:\/\/www\.youtube\.com\/embed\/\w+)(\[\/video\])/gi,'<iframe width="'+this.ytWidth+'" height="'+this.ytHeight+'" src="$3" frameborder="'+this.ytfborder+'" '+this.ytoptions+"></iframe>");return e},htmlclean:function(e){e=e.replace(/(<)([A-Z1-9]+)(>)/gi,function(e){return e.toLowerCase()});e=e.replace(/(<\/)([A-Z1-9]+)(>)/gi,function(e){return e.toLowerCase()});e=e.replace(/<(A|DIV|P)/gi,function(e){return e.toLowerCase()});e=e.replace(/:%s\/<\/\?\\zs\\(\\a\\+\\)\\ze[ >]\/\L\1/gi,"<x$1>");e=e.replace(/(\n){3,}/gi,"\n");e=e.replace(/(\<\/p\>)/gi,"</p>\n");e=e.replace(/(\<br\>)/gi,"<br>\n");e=e.replace(/(&lt;)/gi,"<");e=e.replace(/(&gt;)/gi,">");e=e.replace(/(\&lt;)(xss|script)(\&lt;)/gi,"<$2$3>");e=e.replace(/(\<\/)(xss|script)(\>)/gi,"&lt;/$2&gt;");e=e.replace(/(\<)(img)(\s[^>]*){0,}(javascript|on\w+)([^>]*){0,}(\>)/gi,"&lt;$2$3$4$5&gt;");e=e.replace(/(\<)(iframe)((\x20(width|height|frameborder)="\d+"|allowfullscreen){0,})(\x20src="(http\:\/\/www\.youtube\.com\/embed\/\w+)")([^><]*)(\>\<\/iframe\>)/gi,"[video=youtube]$7[/video]");e=e.replace(/(allowfullscreen)(=\"\")/gi,"$1");e=e.replace(/(\<p\>)(\&nbsp;){0,}(\<\/p\>)/gi,"<br>");e=e.replace(/(\&nbsp;)/gi," ");e=e.replace(/\<p\>\<br\>\n\<\/p\>/gi,"<br>");return e},txtclean:function(e){e=e.replace(/(\<\/p\>\n\n)/g,"</p>");e=e.replace(/(\<br>\n)/g,"<br>");e=e.replace(/(\r)/g,"");e=e.replace(/(\<strong\>)/gi,"<b>");e=e.replace(/(\<\/strong\>)/gi,"</b>");e=this.loadhtml(e);e=e.replace(/(\&#60;)/gi,"<");e=e.replace(/(\&#62;)/gi,">");return e},clean_tags:function(){if(this.isEditable!=false){alert("Not work in Design Mode, please change");return}var e=document.getElementById(this.txteditor);if(!e.setSelectionRange){var t=e.scrollTop;e.focus();var n=document.selection.createRange(this.txteditor);var r=n.text;r=r.replace(/(<([^>]+)>)/gi,"");n.text=r;e.focus();e.scrollTop=t;e.focus();n.select()}else{var i=e.value.substring(0,e.selectionStart);var r=e.value.substring(e.selectionStart,e.selectionEnd);var s=e.value.substring(e.selectionEnd);r=r.replace(/(<([^>]+)>)/gi,"");if(r!=""){e.value=i+r+s}else{e.value=i+s}e.focus();e.selectionStart=i.length+r.length;e.selectionEnd=i.length+r.length;e.focus()}},putsmilley:function(e){this["insertHtml"]("image",e,"","1")},add_newcmd:function(e,t,n,r){ebookRTE.prototype[e]=function(){this["insertHtml"](name,t,n,r)}}};function startEditor(e){e=new ebookRTE(e);return e};function FindMsg(e){var t="",n="",r="";for(var i=0;i<msg.length;i++){t=msg[i].split("|");if(t[0]==e){n=t[1];r=t[2];return{title:n,alt:r}}}return null};function editorCommand(e,t,n){var r=Objects[e];r.editorCommand(t,n)};function uSubmit(e){var t=FindObject(e);if(t.isEditable){var n=document.getElementById(t.htmeditor);var r=n.contentWindow.document.body.innerHTML;r=r.replace(/(\<)(iframe)((\x20(width|height|frameborder)="\d+"|allowfullscreen){0,})(\x20src="(http\:\/\/www\.youtube\.com\/embed\/\w+)")([^><]*)(\>\<\/iframe\>)/gi,"[video=youtube]$7[/video]");r=r.replace(/(<)([A-Z1-9]+)(>)/gi,function(e){return e.toLowerCase()});r=r.replace(/(<\/)([A-Z1-9]+)(>)/gi,function(e){return e.toLowerCase()});r=r.replace(/<(A|DIV|P)/gi,function(e){return e.toLowerCase()});var i=document.getElementById(t.txteditor);i.value=r}};function addEvent(e,t,n){if(e.addEventListener){e.addEventListener(t,n)}else if(e.attachEvent){e.attachEvent("on"+t,n)}else{e["on"+t]=n}};ftoggle=function(e){var t=document.getElementById(e);if(t.style.display===""){t.style.display="none"}else{t.style.display=""}};function chgImg(e,t,n){var r=document.getElementById(e);r.setAttribute("src",n.value)};head_onload=function(e){if(!document.getElementById){return}var t=window.location;var n=t.toString();var r=t.hash.substring(1);var i=window.location.href;var s="";i=i.split("?");if(i[1]!=undefined){i=i[1].split("&");i=i[0].split("=");s="ff"+i[1];i="ff"+i[0]}var o=new Array("login","register","ffpages","ffmyprofile","ffmypassword","fflangs","ffsections","ffasections","ffusers","ffiplugins","ffplugins",i,s);for(var u=0;u<o.length;u++){if(o[u]){var a=document.getElementById(o[u]);if(a!==null){var f=a.length;for(var l=0;l<f;l++){if(a[l].type=="text"||a[l].type=="password"){a[l].focus();break}}}}}};if(document.addEventListener){document.addEventListener("DOMContentLoaded",head_onload,false)}else if(window.attachEvent){window.onload=function(e){head_onload(e)}}window.onload=function(e){head_onload(e)};function textarea_max(e,t){return e.value.length<=t};function hideplace(e,t,n){if(!document.getElementById){return}var r=document.getElementById(e);var i=document.getElementById(t);if(n=="1"){if(i&&r.checked){i.style.display="inline"}else if(i){i.style.display="none"}}else{if(i&&r.checked){i.style.display="none"}else if(i){i.style.display="inline"}}};function chooseplace(e,t,n){if(!document.getElementById){return}var r=document.getElementById(e);var s=n.split("|");for(i=0;i<t;i++){var o=e+i;var u=document.getElementById(o);if(u&&i!=r.value){u.style.display="none"}else if(u&&i==r.value){u.style.display="inline"}}for(j=0;j<s.length;j++){var a=s[j].split("=");var o=e+a[0];var u=document.getElementById(o);if(r.value==a[1]){u.style.display="inline"}}};function tabs(e){for(var t="tab_content_"+e,a=document.getElementsByTagName("div"),n=0;n<a.length;n++)c=a[n].getAttribute("name"),"tab_content"==c&&(a[n].style.display=a[n].id==t?"block":"none");for(var m="tab_"+e,l=document.getElementsByTagName("a"),o=document.getElementsByTagName("li"),n=0;n<l.length;n++){var c=l[n].getAttribute("name");"tab"==c&&(l[n].className=l[n].id==m?"active":"")}for(var m="ltab_"+e,n=0;n<o.length;n++)c=o[n].getAttribute("name"),"tab"==c&&(o[n].className=o[n].id==m?"current":"")}document.cookie="ejava=enabled";